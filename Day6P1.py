puzzle_input = """.....#..#................#...###..............................#..#.......................................#........................
..................#...........#.............#.#.#.#......................#.......##.........................................#.##.#
....#.......................................................#.......#.........................#...................................
.#.............#...........#..........................#.....................................................................#.....
....#..#................#..........................#..#..#...#..........#....................................#.#..................
...........................#....#.##......................................................................##...................#..
...........................#.....................................#....##.#..#..#.....#................#...........................
.....#..............#........#........................................###...........#..................................#..........
........#..............#............................................................#..............................#..............
......#..............................#..........................#................................................#................
................#..#......................#.......................................................................................
..#.............................##.....#.......................................................#..................................
#.......................................#...#.............................#...........#.#.........#.............#.................
..............................#................................#...#................................................#.............
..............#...............#.................#........................#...#.....#................#.............................
...................................#...#...........#...............#.........#............#...............##...........#.#........
.........................#..................................................................#.........#...........................
.##.............#................................#.......#.........#..............................................#...............
....#.................#.....#.......................................................#......................#......................
#..................................#................#......#.........................#............................................
.....#..................#................#........................................................................................
......#......#.......#......#.#....................#..................................#...................#...#...............#.#.
.................................................#......#......#.........#..................#.....................................
...........#.....#..................................#...#........#......#...#..................#.##....#.................#.......#
........#..#....................................#...................................................................#.......#.....
...........#..............#.............................................#..............#.#........#..##.................#.......#.
......................................#............................................#...#..........................................
.......#.............#............................#.........#................#.......................................#............
..........................................................................#.............#...............................#.........
......##...............#..........................................................................................#...............
.........#..#................................................#..................................#.......#.....................#...
...#..............................#.#.............#........................#..............#..............................#........
.......................................................................................................#.............#............
.....#.......................#..#..........#.....................................................................................#
..........##..........................#...............................#.......................#...............#.............#..#..
..#....#....................#.............#......#.............................................................#..................
.#....#..........................................................................................#.#......#.....................#.
..........................#.......#......................................................#........................................
.#......#.#......................................................................#........#.........#.........#.#.................
.....................................#........#..........#.............................#..#............#....................#.....
............#.........#.........................................................................................#........##.......
....................#.................#.........................#......................#......................................#...
............#....................................................#..#.........#..........#...................................#....
#.....#...................#.........#.#..................................................................................#........
.............................##.......#........................................#..........#..............#..#.....................
.............#....................................^.##....................................................#.....................#.
........................#.#..#......................#............#...#..........................#.......................#.........
......................#.......................................................................#.#..#......................#.......
..................................................#.......##...................................#..................................
.............................#..........................................#..............#.#.............................#..........
....#.............#..................#.....#..........................#....#..........#.........#........................#.......#
...............#...........................#...............#....................................................................#.
..........................#.............#..........................................................#..............................
...............#...................................#.......................#.............................#...............#........
....#......................##......#.#................................................#................#.............#............
.......#...................#..........................................#.....................................#.....................
.#.....................#..........................................................................................................
........#.#...........#....#...................................#..#.#....#..................#.#...............#......#........#...
#....#............#...#.........#...........#......................#.....................#........................................
........................#.............#.................................................................#.....#...................
...............#....................#................##...#...........#.#..............#..........................................
........................#...........##.......#.....#...........................#..#...................................#...........
.............#........................................................................#.....#.#.#.................##..............
......#......................#.........#..............#...............#................#..................#........#..............
..........#..........................................................................................................#............
..................#...........#................#..#.#..............#.#........#...............................#....#..........##..
...........#..............#...................................................#...................................................
..................................................................#............#............................#.................#...
....#...........#...................#..........................................#..........#...........................#...........
........................................#....................#....#..#........................#.....#.............................
................#........................................................................................................#........
...................#......#.....#..............#..................................#...#.............#........................#....
...................#............................................................#.............#...................................
.......#........................#..........#.............#....#....#.............#.............................#...#..............
...#...............##.............................................................#.................#........................#....
.............................#.................#..................#.#....................#.....................................###
...............#....#.....................................................#..............................................#.......#
....................................#..................................#.......................#..................................
#..#............#................................#....#...............#.........#...........................#.....................
...........................................................................................................#.............#....#..#
...................................#....#.........#..................#......#....................#..........#.....................
...........#.............................................................##.#......#.....#......................#...#.............
..#...................................................................................#.................#.........#...............
.......#..#..#.................................#.....................#..............................................#....#........
..........................#....................................................................................................#..
..#.............#......#..................................#..#.......................#..........#...#...##......#.................
....#...................#....#.........................................................#..................................#.......
.................................#...............#.....................#..#.......................................................
...........#......................................................................................................#...........#...
.............#.................................................................#............#..................#........#.........
.......................#.......#..........................................................#...............................#.....#.
...........................................................................#....#....#............................#...............
....................#............#................................................................................................
.....#.........................................#...................#.....#...#.......#..............#............................#
...#.......................................#.........#............#...................#......................#....#............##.
...##.#...........................................#...#................#..........................................................
.......#..##............#..#............#......................................#...............#...........#.........#......#..#..
...............................................................................#.........##........##.............#...............
......#...............................#.........#............#..............................#.........................#....#......
#...........................#....#..#....................................................#..................#.....................
......#.##.......#...........................#...#........#.................................................................#.....
..........#.................................................#..........................................#....#.#.........#.#.#.....
...#...#.....#......#.......#..#.#.........#...............................................................#..........##.........#
..#...#...#..........................................#............................#..........#..........#.........................
#....#............#......#.............#.#.......##...............#................#.............................#................
...............................#...............................................................#..............#.........#.........
....#..............#..#............................................................#.......#................#...................#.
....#...........................#.............................#.............#....#.........#....#...................#.......#.#...
.......#.......................................#....#........#..............#........#....................#.......................
........#...........................#................................#............................................................
...........#....#........#......................................#...........#.................................#..........#........
........#..........................................................................................#...........................#..
#........................................#.................................................................##...#.....#...........
............#..............#...........#............#................#..#.......................#.#.....#.............##..........
..........#..................#..................................................................................................#.
.....................................#..............##..................................#.............#........#..................
..............................#..................#...............#......#..##....................#................................
..#............#....................................#.......................................................#...#.................
..................###..........................#.......#.................................#........................................
.....#.#..........................................................#...........##...#.....#.................................#......
.............................................#.............................#......................#.............#.......#.....#...
...#......................#............#..................................#........................#....................#.......#.
....##..........#..........#...#.............#............#....#......#....................#...........#..#..........#............
..#......................#............#..#..#.......................#.........#......#...............#............#..#............
..#.............#.#.............................#......#......#.........................#......#.#...............#...............#
...#...........#...............#.....................................#.................#....#....#...................#.#...#......
.......#........#....................#.............................................#..............................................
........#............................#....#....#........#...................#.#...............#...#.....................#.........
.##........#.................#...........#...............................##.#.....................................................
.###...........................#........#..#................................................#...........................#........."""

import numpy as np
import pandas as pd

# Split the string into rows
rows = puzzle_input.split('\n')
# Make each row a list
char_lists = [list(row) for row in rows]

# Convert to a 2D NumPy array
bigmap = pd.DataFrame(char_lists)

location_tracker = set()

starting_position = np.where(bigmap=='^')
starting_row,starting_col = int(starting_position[0][0]), int(starting_position[1][0])

location_tracker.add((starting_row,starting_col)) #Adding the starting position to the location tracker {(8, 2), (5, 4), (1, 3), (6, 4)}

rows,col = np.where(bigmap=='#')

boundary_positions = set(zip(rows,col)) #Boundary positions is a list of all the obstacles



def moving_upwards(current_row,current_col):
    while current_row > 0:
        current_row-=1
    
        if (current_row,current_col) in boundary_positions:
            return (current_row+1,current_col)
        
        location_tracker.add((current_row,current_col))
        
    # If we reach here, we've gone out of bounds
    return "Out Of Bounds"


def moving_rightwards(current_row,current_col):
    while current_col < bigmap.shape[1] - 1:
        current_col+=1

        if (current_row,current_col) in boundary_positions:
            return(current_row,current_col-1)

        location_tracker.add((current_row,current_col))

    return "Out Of Bounds"



def moving_downwards(current_row,current_col):
    while current_row < bigmap.shape[0] - 1:
        current_row+=1

        if (current_row, current_col) in boundary_positions:
            return(current_row-1,current_col)
        
        location_tracker.add((current_row,current_col))
    
    return "Out Of Bounds"



def moving_leftwards(current_row,current_col):
    while current_col > 0:
        current_col -=1

        if (current_row,current_col) in boundary_positions:
            return(current_row,current_col+1)
        
        location_tracker.add((current_row,current_col))
        
    return "Out Of Bounds"


while True:
    next_position = moving_upwards(starting_row,starting_col)
    if next_position == "Out Of Bounds":    
        break
    else:
        starting_row,starting_col = next_position
    
    next_position = moving_rightwards(starting_row,starting_col)
    if next_position == "Out Of Bounds":    
        break
    else:
        starting_row,starting_col = next_position

    next_position = moving_downwards(starting_row,starting_col)
    if next_position == "Out Of Bounds":    
        break
    else:
        starting_row,starting_col = next_position
    
    next_position = moving_leftwards(starting_row,starting_col)
    if next_position == "Out Of Bounds":    
        break
    else:
        starting_row,starting_col = next_position

    
print("Number of Distinct Locations:", len(location_tracker))

#5239

# for locations in location_tracker:
#     try:
#         current_row,current_col = locations
#         bigmap.iloc[current_row, current_col] = 'X'
#     except IndexError:
#         exit

# print(bigmap)
# print(location_tracker)


# if (5,4) in location_tracker:
#     print("Yes") #Works

# Hard code starting position for guard
# Always starts up
# Create a for loop that iterates through 4 functions:
# Function 1: move upwards until the next upwards column index is == # or IndexError
# Function 2,3,4 are similiar to function 1 but with their respective direction e.g: move rows to the right until next rightwards row index ==# or indexError
# Each function must append the new location to a set
# If IndexError: exit and enter the counting function
# Counting function finds the length of the set
# Return the number of X's